import{r as at}from"../chunks/PD1Wq3xD.js";import{e as Oe,b as ot,g as lt}from"../chunks/Df1CJasG.js";import"../chunks/CWj6FrbW.js";import"../chunks/69_IOA4Y.js";import{p as Ee,l as L,a as nt,b as Fe,s as r,g as e,t as R,d as u,f as ee,m as n,e as w,n as z,c as o,r as v}from"../chunks/Dv5jDC8Z.js";import{a as p,t as W,b as B}from"../chunks/BM_uyzAk.js";import{i as Ce}from"../chunks/CM2QeVoh.js";import{s as Ve,d as it,a as J}from"../chunks/CEr_ApTH.js";import{p as qe}from"../chunks/C4EHgxxn.js";import{P as ut}from"../chunks/PLLlBlGt.js";import{s as Q}from"../chunks/CnnFVxmh.js";import{i as de}from"../chunks/FbCjvpNA.js";import{o as ct,w as ft}from"../chunks/s0RhsljA.js";import{c as dt,P as pt,s as mt,e as wt}from"../chunks/BusX7ieA.js";import{A as vt}from"../chunks/5f3DYfG3.js";import{A as Te}from"../chunks/CXRblWjG.js";import{B as pe}from"../chunks/o0T750pR.js";import{C as Ie}from"../chunks/DV_BD6lz.js";import{I as gt}from"../chunks/CrYHGHR9.js";import{I as me}from"../chunks/Bo_XoIf4.js";import{L as Se}from"../chunks/BtoDfu-7.js";import{L as Ae}from"../chunks/Do7dxYOJ.js";import{E as Qe}from"../chunks/DTSgVZfX.js";import{T as $t}from"../chunks/CcIHoDhR.js";import{t as d}from"../chunks/CZMG2GAD.js";import{g as kt}from"../chunks/zyxutAoK.js";import{b as _t}from"../chunks/BOxXvrkj.js";import{t as We}from"../chunks/S8vTd6-A.js";import{p as ht}from"../chunks/Be5fLl4T.js";import{u as je}from"../chunks/BRmgPntg.js";import{w as bt}from"../chunks/DR_0pkbg.js";import{v as yt}from"../chunks/Dz_GI0CC.js";const xt=async function({params:j,parent:O}){var l,k;const i=await O();if(((l=i==null?void 0:i.settings)==null?void 0:l.disableWriteActions)||((k=i==null?void 0:i.settings)==null?void 0:k.startWorkflowDisabled)){const{namespace:_}=j;at(302,Oe({namespace:_}))}},cr=Object.freeze(Object.defineProperty({__proto__:null,load:xt},Symbol.toStringTag,{value:"Module"}));var Pt=W('<div class="flex w-full items-center justify-between"><p> </p> <!></div>'),Tt=W('<div class="flex flex-wrap justify-between"><h3> </h3> <p class="flex items-center gap-1 text-sm text-subtle"> <!></p></div> <!> <!> <!> <!>',1),It=W("<!> <!>",1),St=W('<div class="flex w-full flex-col justify-between gap-2 sm:items-center md:flex-row md:gap-4"><!> <!></div> <div class="flex w-full items-center justify-between gap-4"><!></div> <!> <!> <!> <!> <div class="mt-4 flex w-full flex-row justify-between gap-4 max-sm:flex-col"><!> <!></div> <!>',1),At=W('<div class="flex w-full flex-col gap-4 pb-20"><!> <h1 class="mb-4 overflow-hidden" data-testid="start-workflow">Start a Workflow</h1> <!></div>');function Qt(j,O){Ee(O,!1);const[i,M]=Ve(),l=()=>J(qe,"$page",i),k=()=>J(e(H),"$encoding",i),_=()=>J(_t,"$customSearchAttributes",i),te=()=>J(wt,"$workflowsSearchParams",i),g=n(),re=n(),se=n(),we=n();let m=n(""),h=n(""),T=n(""),b=n(""),N=n(""),U=n(""),H=n(ft("json/plain")),K=n(""),ae="",oe="",G=n(""),I=n(void 0),E=n(!1),F=n([]);ct(()=>{r(m,l().url.searchParams.get("workflowId")||""),r(h,l().url.searchParams.get("taskQueue")||""),r(T,l().url.searchParams.get("workflowType")||""),ae=l().url.searchParams.get("workflowId")||"",oe=l().url.searchParams.get("workflowType")||"",(ae||oe)&&ze(ae,oe)});const De=async()=>{try{r(G,"");const{runId:a}=await mt({namespace:e(g),workflowId:e(m),taskQueue:e(h),workflowType:e(T),input:e(b),summary:e(N),details:e(U),encoding:k(),messageType:e(K),searchAttributes:e(F)});We.push({variant:"success",duration:5e3,message:d("workflows.start-workflow-success"),link:ot({namespace:e(g),workflow:e(m),run:a})})}catch(a){r(G,(a==null?void 0:a.message)||d("workflows.start-workflow-error")),We.push({variant:"error",message:d("workflows.start-workflow-error")})}},Le=()=>{r(m,yt()),je({parameter:"workflowId",value:e(m),url:l().url,allowEmpty:!0,options:{keepFocus:!0,noScroll:!0,replaceState:!0}})},Re=async a=>{if(a){const{pollers:$}=await kt({namespace:e(g),queue:a});r(I,$.length)}},ze=async(a,$)=>{var f;const s=await dt({namespace:e(g),workflowId:a,workflowType:$});if(r(b,s.input),e(H).set(s.encoding),r(K,s.messageType),r(N,s.summary),r(U,s.details),s!=null&&s.searchAttributes){const X=Object.keys(_());Object.entries(s.searchAttributes).forEach(([C,V])=>{X.includes(C)&&r(F,[...e(F),{label:C,value:V,type:_()[C]}])})}(Object.keys((f=s==null?void 0:s.searchAttributes)!==null&&f!==void 0?f:{}).length||s!=null&&s.summary||s!=null&&s.details)&&r(E,!0)},le=(a,$)=>{const f=a.target.value;je({parameter:$,value:f,url:l().url,allowEmpty:!0,options:{keepFocus:!0,noScroll:!0,replaceState:!0}})},Be=a=>{try{return JSON.parse(a),!0}catch{return!1}};L(()=>(e(g),l()),()=>{(a=>r(g,a.namespace))(l().params)}),L(()=>l(),()=>{r(re,l().url.searchParams.get("taskQueue"))}),L(()=>e(b),()=>{r(se,!e(b)||Be(e(b)))}),L(()=>(e(m),e(h),e(T),e(se),l()),()=>{r(we,!!e(m)&&!!e(h)&&!!e(T)&&!!e(se)&&!bt(l()))}),L(()=>e(re),()=>{Re(e(re))}),nt(),Ce();var ne=At(),ve=w(ne);const Je=u(()=>`${Oe({namespace:e(g)})}?${te()}`);Ae(ve,{get href(){return e(Je)},"data-testid":"back-to-workflows",icon:"chevron-left",children:(a,$)=>{z();var f=B();R(s=>Q(f,s),[()=>d("workflows.back-to-workflows")],u),p(a,f)},$$slots:{default:!0}});var Me=o(ve,4);Ie(Me,{class:"flex w-full flex-col gap-4 xl:w-3/4 2xl:w-1/2",children:(a,$)=>{var f=St(),s=ee(f),X=w(s);me(X,{id:"workflowId",required:!0,label:"Workflow ID",class:"w-full grow",get value(){return e(m)},set value(t){r(m,t)},$$events:{blur:t=>le(t,"workflowId")},$$legacy:!0});var C=o(X,2);pe(C,{class:"mt-0 md:mt-6",variant:"secondary",leadingIcon:"retry",$$events:{click:Le},children:(t,y)=>{z();var c=B("Random UUID");p(t,c)},$$slots:{default:!0}}),v(s);var V=o(s,2),Ne=w(V);me(Ne,{id:"taskQueue",required:!0,label:"Task Queue",class:"grow",get value(){return e(h)},set value(t){r(h,t)},$$events:{blur:t=>le(t,"taskQueue")},$$legacy:!0}),v(V);var ge=o(V,2);{var Ue=t=>{const y=u(()=>e(I)>0?"success":"warning"),c=u(()=>e(I)?"Task Queue is Active":"Task Queue is Inactive");Te(t,{get intent(){return e(y)},get title(){return e(c)},children:(x,Y)=>{var Z=Pt(),S=w(Z),q=w(S);v(S);var D=o(S,2);const ue=u(()=>lt({namespace:e(g),queue:e(h)}));Ae(D,{get href(){return e(ue)},newTab:!0,children:(A,ce)=>{z();var fe=B("View Task Queue");p(A,fe)},$$slots:{default:!0}}),v(Z),R(A=>Q(q,`${e(I)??""}
            ${A??""}`),[()=>ht("Worker",e(I))],u),p(x,Z)},$$slots:{default:!0}})};de(ge,t=>{e(I)!==void 0&&t(Ue)})}var $e=o(ge,2);me($e,{id:"workflowType",required:!0,label:"Workflow Type",get value(){return e(T)},set value(t){r(T,t)},$$events:{blur:t=>le(t,"workflowType")},$$legacy:!0});var ke=o($e,2);pt(ke,{get input(){return e(b)},set input(t){r(b,t)},get encoding(){return e(H)},set encoding(t){it(r(H,t),"$encoding",i)},get messageType(){return e(K)},set messageType(t){r(K,t)},$$legacy:!0});var _e=o(ke,2);{var He=t=>{var y=It(),c=ee(y);Ie(c,{class:"flex flex-col gap-2",children:(Y,Z)=>{var S=Tt(),q=ee(S),D=w(q),ue=w(D,!0);v(D);var A=o(D,2),ce=w(A),fe=o(ce);const et=u(()=>d("workflows.markdown-description"));$t(fe,{topRight:!0,width:200,get text(){return e(et)},children:(P,Pe)=>{gt(P,{name:"info"})},$$slots:{default:!0}}),v(A),v(q);var be=o(q,2);const tt=u(()=>d("workflows.summary"));Se(be,{get label(){return e(tt)},for:"summary"});var ye=o(be,2);Qe(ye,{get content(){return e(N)},class:"min-h-48",$$events:{change:P=>r(N,P.detail.value)}});var xe=o(ye,2);const rt=u(()=>d("workflows.details"));Se(xe,{get label(){return e(rt)},for:"details"});var st=o(xe,2);Qe(st,{get content(){return e(U)},$$events:{change:P=>r(U,P.detail.value)}}),R((P,Pe)=>{Q(ue,P),Q(ce,`${Pe??""} `)},[()=>d("workflows.user-metadata"),()=>d("workflows.markdown-supported")],u),p(Y,S)},$$slots:{default:!0}});var x=o(c,2);vt(x,{get attributesToAdd(){return e(F)},set attributesToAdd(Y){r(F,Y)},$$legacy:!0}),p(t,y)};de(_e,t=>{e(E)&&t(He)})}var ie=o(_e,2),he=w(ie);const Ke=u(()=>e(E)?"chevron-up":"chevron-down");pe(he,{variant:"ghost",class:"max-sm:w-full",get trailingIcon(){return e(Ke)},$$events:{click:()=>r(E,!e(E))},children:(t,y)=>{z();var c=B();R(x=>Q(c,x),[()=>d("common.more-options")],u),p(t,c)},$$slots:{default:!0}});var Ge=o(he,2);const Xe=u(()=>!e(we));pe(Ge,{get disabled(){return e(Xe)},"data-testid":"start-workflow-button",class:"max-sm:w-full",$$events:{click:De},children:(t,y)=>{z();var c=B();R(x=>Q(c,x),[()=>d("workflows.start-workflow")],u),p(t,c)},$$slots:{default:!0}}),v(ie);var Ye=o(ie,2);{var Ze=t=>{Te(t,{intent:"error",get title(){return e(G)}})};de(Ye,t=>{e(G)&&t(Ze)})}p(a,f)},$$slots:{default:!0}}),v(ne),p(j,ne),Fe(),M()}var Wt=W("<!> <!>",1);function fr(j,O){Ee(O,!1);const[i,M]=Ve(),l=()=>J(qe,"$page",i);Ce();var k=Wt(),_=ee(k);ut(_,{title:"Start Workflow",get url(){return l().url.href}});var te=o(_,2);Qt(te,{}),p(j,k),Fe(),M()}export{fr as component,cr as universal};
