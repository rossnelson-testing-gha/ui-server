import"../chunks/CWj6FrbW.js";import"../chunks/69_IOA4Y.js";import{p as ne,f as se,t as $,b as oe,g as t,d as c,s as i,m as N,e as m,n as k,r as u,c as l,l as re,a as ke,ag as De}from"../chunks/Dv5jDC8Z.js";import{a as g,t as S,b as D}from"../chunks/BM_uyzAk.js";import{i as le}from"../chunks/CM2QeVoh.js";import{p as v}from"../chunks/BbkaS_Cl.js";import{s as ie,a as j}from"../chunks/CEr_ApTH.js";import{g as R}from"../chunks/Dt0BXCrN.js";import{p as de}from"../chunks/DUbvhX2N.js";import{P as Ee}from"../chunks/PLLlBlGt.js";import{t as s}from"../chunks/CZMG2GAD.js";import{s as d}from"../chunks/CnnFVxmh.js";import{B as I}from"../chunks/Dwfpj6FK.js";import{I as Te}from"../chunks/8SvWOUh3.js";import{L as Ce}from"../chunks/JRCi7r2-.js";import{M as Fe}from"../chunks/CvPNX5O5.js";import{N as Me,e as Ae}from"../chunks/Bw6xrwpJ.js";import{j as z,h as He}from"../chunks/Bejpy5M8.js";import{u as Ie,d as je}from"../chunks/94CwJv4C.js";import{n as ze}from"../chunks/CL06mzCM.js";import{e as Re}from"../chunks/BNKVzXSn.js";var Se=S('<h3 slot="title"> </h3>'),Ue=S('<div slot="content" class="flex flex-col gap-4"><p> <strong class="select-all"> </strong> </p> <p> <strong class="select-all"> </strong> </p> <!></div>'),Ze=S('<div class="flex flex-col gap-8"><div class="relative flex flex-col gap-4 text-sm"><!></div> <div class="flex flex-col gap-1"><h1 data-testid="namespace-selector-title"> </h1></div> <!> <div class="flex w-full flex-row items-center justify-between gap-4 max-sm:flex-col xl:w-1/2"><div class="items-centeritems-center flex w-full flex-row gap-4 max-sm:flex-col"><!> <!></div> <!> <!></div></div> <!>',1);function Be(U,o){ne(o,!1);const[w,Z]=ie(),P=()=>j(de,"$page",w);let x=v(o,"endpoint",8),E=v(o,"targetNamespaceList",24,()=>[]),f=v(o,"callerNamespaceList",24,()=>[]),T=v(o,"onUpdate",8),C=v(o,"onDelete",8),h=v(o,"error",8,void 0),_=v(o,"loading",8,!1),B=v(o,"isCloud",8,!1),O=v(o,"nameRegexPattern",8,/^[a-zA-Z][a-zA-Z0-9-]*[a-zA-Z0-9]$/),F=v(o,"nameHintText",24,()=>s("nexus.endpoint-name-hint-with-dash")),y=N(!1),b=N("");le();var M=Ze(),r=se(M),L=m(r),A=m(L);const ce=c(()=>z(P().params.id));Ce(A,{get href(){return t(ce)},icon:"chevron-left",children:(a,p)=>{k();var e=D();$(n=>d(e,n),[()=>s("nexus.back-to-endpoint")],c),g(a,e)},$$slots:{default:!0}}),u(L);var q=l(L,2),W=m(q),pe=m(W,!0);u(W),u(q);var X=l(q,2);Me(X,{get endpoint(){return x()},get nameHintText(){return F()},get nameRegexPattern(){return O()},get targetNamespaceList(){return E()},get callerNamespaceList(){return f()},get error(){return h()},get isCloud(){return B()},nameDisabled:!0});var Y=l(X,2),J=m(Y),ee=m(J);I(ee,{class:"max-sm:w-full",get loading(){return _()},$$events:{click(...a){var p;(p=T())==null||p.apply(this,a)}},children:(a,p)=>{k();var e=D();$(n=>d(e,n),[()=>s("common.save")],c),g(a,e)},$$slots:{default:!0}});var me=l(ee,2);I(me,{class:"max-sm:hidden",variant:"ghost",$$events:{click:()=>R(z(P().params.id))},children:(a,p)=>{k();var e=D();$(n=>d(e,n),[()=>s("common.cancel")],c),g(a,e)},$$slots:{default:!0}}),u(J);var te=l(J,2);I(te,{class:"max-sm:w-full",variant:"destructive",$$events:{click:()=>i(y,!0)},children:(a,p)=>{k();var e=D();$(n=>d(e,n),[()=>s("common.delete")],c),g(a,e)},$$slots:{default:!0}});var ue=l(te,2);I(ue,{class:"w-full sm:hidden",variant:"ghost",$$events:{click:()=>R(z(P().params.id))},children:(a,p)=>{k();var e=D();$(n=>d(e,n),[()=>s("common.cancel")],c),g(a,e)},$$slots:{default:!0}}),u(Y),u(r);var fe=l(r,2);const ve=c(()=>s("common.delete")),ge=c(()=>s("common.cancel")),xe=c(()=>t(b)!==x().spec.name);Fe(fe,{id:"delete-endpoint-modal",get loading(){return _()},confirmType:"destructive",get confirmText(){return t(ve)},get cancelText(){return t(ge)},get confirmDisabled(){return t(xe)},get open(){return t(y)},set open(a){i(y,a)},$$events:{confirmModal(...a){var p;(p=C())==null||p.apply(this,a)},cancelModal:()=>i(y,!1)},$$slots:{title:(a,p)=>{var e=Se(),n=m(e,!0);u(e),$(H=>d(n,H),[()=>s("nexus.delete-modal-title")],c),g(a,e)},content:(a,p)=>{var e=Ue(),n=m(e),H=m(n),G=l(H),_e=m(G,!0);u(G);var $e=l(G);u(n);var K=l(n,2),ae=m(K),Q=l(ae),he=m(Q,!0);u(Q);var ye=l(Q);u(K);var Ne=l(K,2);const we=c(()=>s("nexus.delete-endpoint"));Te(Ne,{id:"delete-endpoint",labelHidden:!0,get label(){return t(we)},get value(){return t(b)},set value(V){i(b,V)},$$legacy:!0}),u(e),$((V,Pe,be,Le)=>{d(H,`${V??""} `),d(_e,x().spec.name),d($e,`?
      ${Pe??""}`),d(ae,`${be??""} `),d(he,x().spec.name),d(ye,` ${Le??""}`)},[()=>s("nexus.delete-modal-confirmation-preface"),()=>s("nexus.delete-modal-confirmation-postface"),()=>s("nexus.type-confirm-preface"),()=>s("nexus.type-confirm-postface")],c),g(a,e)}},$$legacy:!0}),$(()=>d(pe,x().spec.name)),g(U,M),oe(),Z()}var Oe=S("<!> <!>",1);function mt(U,o){ne(o,!1);const[w,Z]=ie(),P=()=>j(Ae,"$endpointForm",w),x=()=>j(ze,"$namespaces",w),E=()=>j(de,"$page",w),f=N(),T=N();let C=v(o,"data",8),h=N(void 0),_=N(!1);const B=async()=>{i(h,void 0),i(_,!0);const r={...P()};r.id=t(f).id,r.version=t(f).version;const L=await Re({input:JSON.stringify(r.spec.descriptionString),encoding:"json/plain"});r.spec.description=L[0],delete r.spec.allowedCallerNamespaces,delete r.spec.descriptionString;try{await Ie(t(f).id,r),R(z(t(f).id),{invalidateAll:!0})}catch(A){i(h,A),console.error("Error updating endpoint",A)}finally{i(_,!1)}},O=async()=>{i(h,void 0),i(_,!0);try{await je(t(f).id,t(f).version),R(He())}catch(r){i(h,r),console.error("Error deleting endpoint",r)}finally{i(_,!1)}};re(()=>(t(f),De(C())),()=>{(r=>i(f,r.endpoint))(C())}),re(()=>x(),()=>{i(T,x().map(r=>({namespace:r.namespaceInfo.name})))}),ke(),le();var F=Oe(),y=se(F);const b=c(()=>`Edit ${s("nexus.nexus-endpoint",{id:E().params.id})}`);Ee(y,{get title(){return t(b)},get url(){return E().url.href}});var M=l(y,2);Be(M,{get endpoint(){return t(f)},get loading(){return t(_)},get targetNamespaceList(){return t(T)},onUpdate:B,onDelete:O,get error(){return t(h)}}),g(U,F),oe(),Z()}export{mt as component};
